sudo su - root

# installer k3s
curl -sfL https://get.k3s.io | sh -


# récupérer la config kube du server local
mkdir -p ~/.kube
cp /etc/rancher/k3s/k3s.yaml ~/.kube/config

# installer nerdctl 
NERDCTL_VERSION="1.7.7"
wget "https://github.com/containerd/nerdctl/releases/download/v${NERDCTL_VERSION}/nerdctl-full-${NERDCTL_VERSION}-linux-amd64.tar.gz"
sudo tar Cxzvvf /usr/local - < nerdctl-full-${NERDCTL_VERSION}-linux-amd64.tar.gz
sudo systemctl enable --now buildkit
mkdir -p ~/.config/nerdctl
cat <<EOF > ~/.config/nerdctl/nerdctl.toml
address = "/run/k3s/containerd/containerd.sock"
namespace = "k8s.io"
EOF

# installer skaffold
curl -Lo skaffold https://storage.googleapis.com/skaffold/releases/latest/skaffold-linux-amd64
sudo install skaffold /usr/local/bin/
rm skaffold

